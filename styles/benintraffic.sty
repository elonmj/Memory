\ProvidesPackage{benintraffic}[2023/10/01 Beautiful style for Benin traffic document]

% Load required packages
\RequirePackage{fontspec}
\RequirePackage{xcolor}
\RequirePackage{titlesec}
\RequirePackage{fancyhdr}
\RequirePackage{geometry}
\RequirePackage{setspace}
\RequirePackage{booktabs}
\RequirePackage{thmtools}
\RequirePackage{mathtools}
\RequirePackage{pgfplots}
\RequirePackage{enumitem}
\RequirePackage{empheq}
\RequirePackage{mdframed}
\RequirePackage{etoolbox}

% Define traffic-related color scheme
\definecolor{roadgray}{RGB}{80,80,80}
\definecolor{darkblue}{RGB}{0,43,112}
\definecolor{midblue}{RGB}{0,90,170}
\definecolor{lightblue}{RGB}{135,206,250}
\definecolor{trafficred}{RGB}{200,30,15}
\definecolor{trafficyellow}{RGB}{240,200,0}
\definecolor{trafficgreen}{RGB}{0,128,0}
\definecolor{midgray}{RGB}{120,120,120}
\definecolor{pagebackground}{RGB}{252,252,250}

% Set page background color
\pagecolor{pagebackground}

% Typography settings
\setstretch{1.15}

% Beautiful chapter and section styling
\titleformat{\chapter}[display]
  {\normalfont\huge\bfseries\color{darkblue}}
  {\flushright\normalsize\color{midgray}CHAPITRE\\\Huge\thechapter}
  {20pt}
  {\titlerule[0.5pt]\vspace{6pt}\huge}
  [\vspace{.5ex}\titlerule[0.5pt]]

\titleformat{\section}
  {\normalfont\Large\bfseries\color{darkblue}}
  {\thesection}
  {0.75em}
  {}

\titleformat{\subsection}
  {\normalfont\large\bfseries\color{midblue}}
  {\thesubsection}
  {0.75em}
  {}

% Header and footer design
\pagestyle{fancy}
\fancyhf{}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

\fancyhead[LE,RO]{\thepage}
\fancyhead[RE]{\textit{\leftmark}}
\fancyhead[LO]{\textit{\rightmark}}
\fancyfoot[C]{\small Modélisation du Trafic Routier au Bénin}
\fancyheadoffset{0.5cm}
\setlength{\headheight}{15pt}

% Enhanced lists
\setlist[itemize]{leftmargin=*,label=\textcolor{darkblue}{$\blacktriangleright$}}
\setlist[enumerate]{leftmargin=*,label=\textcolor{darkblue}{\arabic*.},font=\color{darkblue}\bfseries}

% Beautiful theorems styling
\declaretheoremstyle[
    headfont=\normalfont\bfseries\color{darkblue},
    notefont=\normalfont\bfseries\color{darkblue},
    bodyfont=\normalfont\itshape,
    headpunct={:},
    postheadspace=1em,
    spaceabove=12pt,
    spacebelow=12pt,
    mdframed={
        linewidth=1pt,
        linecolor=darkblue,
        backgroundcolor=lightblue!5,
        roundcorner=5pt
    }
]{prettytheorem}

\declaretheorem[style=prettytheorem,name=Théorème]{theorem}
\declaretheorem[style=prettytheorem,name=Proposition]{proposition}
\declaretheorem[style=prettytheorem,name=Lemme]{lemma}
\declaretheorem[style=prettytheorem,name=Corollaire]{corollary}

% Simpler style for definitions
\declaretheoremstyle[
    headfont=\normalfont\bfseries,
    bodyfont=\normalfont,
    headpunct={:},
    postheadspace=1em,
    spaceabove=6pt,
    spacebelow=6pt,
]{simpledefinition}

\declaretheorem[style=simpledefinition,name=Définition]{definition}
\declaretheorem[style=simpledefinition,name=Remarque]{remark}
\declaretheorem[style=simpledefinition,name=Exemple]{example}

% Highlight equation box
\newcommand{\highlight}[1]{%
\colorbox{lightblue!15}{$\displaystyle#1$}}

% Custom traffic modeling commands
\newcommand{\dens}{\rho}                  % Traffic density
\newcommand{\vel}{v}                      % Traffic velocity
\newcommand{\flow}{q}                     % Traffic flow
\newcommand{\densi}[1]{\rho_{#1}}         % Density of class i
\newcommand{\veli}[1]{v_{#1}}             % Velocity of class i
\newcommand{\flowi}[1]{q_{#1}}            % Flow of class i
\newcommand{\densM}{\rho_{\text{M}}}      % Motorcycle density
\newcommand{\velM}{v_{\text{M}}}          % Motorcycle velocity
\newcommand{\flowM}{q_{\text{M}}}         % Motorcycle flow
\newcommand{\maxdens}{\rho_{\text{max}}}  % Maximum density
\newcommand{\maxvel}{v_{\text{max}}}      % Maximum velocity
\newcommand{\maxdensM}{\rho_{\text{M,max}}} % Maximum motorcycle density
\newcommand{\maxveli}[1]{v_{{#1},\text{max}}^0} % Free flow speed for class i
\newcommand{\matcoef}[1]{\lambda_{\text{mat},{#1}}} % Material coefficient for class i
\newcommand{\modM}[1]{f_{\text{M},{#1}}} % Motorcycle modulation function
\newcommand{\etaM}{\eta_{\text{M}}}      % Gap-filling coefficient
\newcommand{\mui}[1]{\mu_{#1}}           % Interweaving coefficient

% Calculus operations
\newcommand{\pd}[2]{\frac{\partial #1}{\partial #2}} % Partial derivative
\newcommand{\pdd}[2]{\frac{\partial^2 #1}{\partial #2^2}} % Second partial derivative
\newcommand{\pdm}[3]{\frac{\partial^2 #1}{\partial #2 \partial #3}} % Mixed partial derivative

% Traffic-specific terms
\newcommand{\deltaQ}{\Delta q}            % Flow variation at intersections
\newcommand{\greenT}{g(t)}                % Green time function
\newcommand{\interS}{S_i(x,t)}            % Source/sink term for class i

% Spacing between paragraphs in specific environments
\BeforeBeginEnvironment{theorem}{\vspace{1ex}}
\AfterEndEnvironment{theorem}{\vspace{1ex}}
\BeforeBeginEnvironment{definition}{\vspace{1ex}}
\AfterEndEnvironment{definition}{\vspace{1ex}}

% Algorithm styling
\algnewcommand{\LeftComment}[1]{\hfill\(\triangleright\) #1}

% Configure PGFPlots
\pgfplotsset{
    compat=newest,
    every axis/.append style={
        line width=0.5pt,
        tick style={color=midgray, line width=0.5pt}
    }
}

\endinput